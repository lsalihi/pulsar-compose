version: "0.1"
name: "Data Analysis Pipeline"
description: "A comprehensive data analysis workflow that processes, analyzes, and visualizes datasets"
agents:
  data_ingestor:
    model: "gpt-4"
    provider: "openai"
    prompt: "Analyze this dataset description: {{input}}. Identify data types, quality issues, missing values, outliers, and preprocessing requirements. Suggest appropriate analysis approaches and potential insights."
    parameters:
      temperature: 0.3
      max_tokens: 800

  data_cleaner:
    model: "claude-3-haiku-20240307"
    provider: "anthropic"
    prompt: "Based on this data assessment: {{data_ingestor.output}}, create a data cleaning and preprocessing plan. Include steps for handling missing values, outliers, normalization, encoding categorical variables, and feature engineering."
    parameters:
      temperature: 0.2
      max_tokens: 900

  statistical_analyzer:
    model: "gpt-4"
    provider: "openai"
    prompt: "Perform statistical analysis on this dataset. Assessment: {{data_ingestor.output}}. Include descriptive statistics, correlation analysis, hypothesis testing, and identify key patterns or relationships in the data."
    parameters:
      temperature: 0.4
      max_tokens: 1000

  machine_learning_specialist:
    model: "claude-3-sonnet-20240229"
    provider: "anthropic"
    prompt: "Based on the data analysis: {{statistical_analyzer.output}}, suggest appropriate machine learning models and techniques. Consider: predictive modeling, clustering, classification, or other ML approaches. Explain your recommendations with reasoning."
    parameters:
      temperature: 0.5
      max_tokens: 1100

  visualization_expert:
    model: "gpt-4"
    provider: "openai"
    prompt: "Design data visualizations for this analysis. Statistical results: {{statistical_analyzer.output}}. Create descriptions for charts, graphs, and dashboards that effectively communicate the key insights. Include specific visualization types and data mappings."
    parameters:
      temperature: 0.4
      max_tokens: 800

  insights_summarizer:
    model: "claude-3-sonnet-20240229"
    provider: "anthropic"
    prompt: "Synthesize key insights from this data analysis. Statistical analysis: {{statistical_analyzer.output}}, ML recommendations: {{machine_learning_specialist.output}}, Visualizations: {{visualization_expert.output}}. Provide actionable insights, business implications, and recommendations."
    parameters:
      temperature: 0.5
      max_tokens: 1200

  report_generator:
    model: "gpt-4"
    provider: "openai"
    prompt: "Create a comprehensive data analysis report. Include: executive summary, methodology, key findings, insights, recommendations, and next steps. Base it on: Data assessment: {{data_ingestor.output}}, Cleaning plan: {{data_cleaner.output}}, Analysis: {{statistical_analyzer.output}}, ML insights: {{machine_learning_specialist.output}}"
    parameters:
      temperature: 0.6
      max_tokens: 1500

workflow:
  - type: agent
    step: "assess_data"
    agent: "data_ingestor"
    save: "data_assessment"

  - type: agent
    step: "plan_cleaning"
    agent: "data_cleaner"
    save: "cleaning_plan"

  - type: agent
    step: "analyze_statistics"
    agent: "statistical_analyzer"
    save: "statistical_analysis"

  - type: conditional
    step: "complexity_check"
    if: "{{data_assessment | regex_search(r'complexity: (\\w+)') | lower == 'high' or statistical_analyzer | regex_search(r'variables.*(\\d+)') | int > 20}}"
    then:
      - type: agent
        step: "ml_modeling"
        agent: "machine_learning_specialist"
        save: "ml_recommendations"
      - type: agent
        step: "create_visualizations"
        agent: "visualization_expert"
        save: "visualization_plan"
      - type: agent
        step: "synthesize_insights"
        agent: "insights_summarizer"
        save: "key_insights"
      - type: agent
        step: "generate_report"
        agent: "report_generator"
        save: "final_report"
    else:
      - type: agent
        step: "create_visualizations_simple"
        agent: "visualization_expert"
        save: "visualization_plan"
      - type: agent
        step: "synthesize_insights_simple"
        agent: "insights_summarizer"
        save: "key_insights"
      - type: agent
        step: "generate_report_simple"
        agent: "report_generator"
        save: "final_report"