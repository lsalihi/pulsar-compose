version: "0.1"
name: "Research Analysis Pipeline"
description: "A comprehensive research and analysis workflow that gathers, analyzes, and synthesizes information on complex topics"
agents:
  research_planner:
    model: "gpt-4"
    provider: "openai"
    prompt: "Create a research plan for the topic: {{input}}. Identify key research questions, data sources, methodologies, and expected outcomes. Structure the plan clearly."
    parameters:
      temperature: 0.5
      max_tokens: 800

  data_collector:
    model: "claude-3-sonnet-20240229"
    provider: "anthropic"
    prompt: "Based on this research plan: {{research_planner.output}}, gather relevant data and information. Include statistics, studies, expert opinions, and current trends. Be comprehensive but focused."
    parameters:
      temperature: 0.3
      max_tokens: 1500

  data_analyzer:
    model: "gpt-4"
    provider: "openai"
    prompt: "Analyze this collected data: {{data_collector.output}}. Identify patterns, trends, correlations, and insights. Use statistical reasoning and critical thinking. Provide evidence-based conclusions."
    parameters:
      temperature: 0.4
      max_tokens: 1200

  expert_reviewer:
    model: "claude-3-sonnet-20240229"
    provider: "anthropic"
    prompt: "Review this analysis: {{data_analyzer.output}}. Check for methodological soundness, logical consistency, and completeness. Suggest improvements and additional considerations. Act as a domain expert."
    parameters:
      temperature: 0.3
      max_tokens: 1000

  report_writer:
    model: "gpt-4"
    provider: "openai"
    prompt: "Write a comprehensive research report based on: Analysis: {{data_analyzer.output}}, Review: {{expert_reviewer.output}}, Original Plan: {{research_planner.output}}. Include executive summary, methodology, findings, conclusions, and recommendations."
    parameters:
      temperature: 0.5
      max_tokens: 2000

  visualization_specialist:
    model: "claude-3-haiku-20240307"
    provider: "anthropic"
    prompt: "Create descriptions for data visualizations based on this research: {{data_analyzer.output}}. Suggest charts, graphs, and diagrams that would effectively communicate the key findings. Include specific data points and visual concepts."
    parameters:
      temperature: 0.4
      max_tokens: 800

workflow:
  - type: agent
    step: "plan_research"
    agent: "research_planner"
    save: "research_plan"

  - type: agent
    step: "collect_data"
    agent: "data_collector"
    save: "collected_data"

  - type: agent
    step: "analyze_data"
    agent: "data_analyzer"
    save: "data_analysis"

  - type: agent
    step: "expert_review"
    agent: "expert_reviewer"
    save: "expert_review"

  - type: conditional
    step: "quality_check"
    if: "{{expert_review | regex_search(r'Overall quality: (\\w+)') | lower == 'excellent' or expert_review | regex_search(r'Overall quality: (\\w+)') | lower == 'good'}}"
    then:
      - type: agent
        step: "write_report"
        agent: "report_writer"
        save: "final_report"
      - type: agent
        step: "create_visualizations"
        agent: "visualization_specialist"
        save: "visualizations"
    else:
      - type: agent
        step: "revise_analysis"
        agent: "data_analyzer"
        context: "Revise this analysis based on expert feedback: {{expert_review}}. Original data: {{collected_data}}"
        save: "revised_analysis"
      - type: agent
        step: "write_report_revised"
        agent: "report_writer"
        save: "final_report"
      - type: agent
        step: "create_visualizations"
        agent: "visualization_specialist"
        save: "visualizations"